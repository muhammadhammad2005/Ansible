---
- name: Validate Apache Deployment
  hosts: localhost
  become: yes

  tasks:
    - name: Gather service facts
      service_facts:

    - name: Verify Apache service is running
      assert:
        that:
          - ansible_facts.services['httpd.service'].state == 'running'
        fail_msg: "Apache service is not running"
        success_msg: "Apache service is running successfully"

    - name: Test HTTP response
      uri:
        url: http://localhost
        status_code: 200

    - name: Check if custom index.html exists
      stat:
        path: /var/www/html/index.html
      register: index_file

    - name: Verify index.html was created
      assert:
        that:
          - index_file.stat.exists
        fail_msg: "Custom index.html file not found"
        success_msg: "Custom index.html file exists"

